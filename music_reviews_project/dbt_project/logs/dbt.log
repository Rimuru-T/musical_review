[0m18:30:26.128568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be26ad92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be256210d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be24855cd0>]}


============================== 18:30:26.147589 | 1c3a56a2-6cf3-47cb-8cd4-9ee7976d91f9 ==============================
[0m18:30:26.147589 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:30:26.149309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:26.317909 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "music_reviews", target "dev" invalid: 5340 is not of type 'string'
[0m18:30:26.321417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35763055, "process_user_time": 4.124175, "process_kernel_time": 0.550954, "process_mem_max_rss": "160812", "process_in_blocks": "28096", "process_out_blocks": "1680", "command_success": false}
[0m18:30:26.326042 [debug] [MainThread]: Command `dbt run` failed at 18:30:26.325575 after 0.36 seconds
[0m18:30:26.328491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be26ad92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be2486db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71be24855d30>]}
[0m18:30:26.330383 [debug] [MainThread]: Flushing usage events
[0m18:40:20.183718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b696afa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b695002a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b6949d8850>]}


============================== 18:40:20.196979 | 638316aa-7c00-492d-bff6-1f29bfb4232c ==============================
[0m18:40:20.196979 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:20.199281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:20.309256 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "music_reviews", target "dev" invalid: 5340 is not of type 'string'
[0m18:40:20.311237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.25193077, "process_user_time": 3.741142, "process_kernel_time": 0.271212, "process_mem_max_rss": "93384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:20.312532 [debug] [MainThread]: Command `dbt run` failed at 18:40:20.312366 after 0.25 seconds
[0m18:40:20.313745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b696afa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b694961700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b693134490>]}
[0m18:40:20.315342 [debug] [MainThread]: Flushing usage events
[0m18:41:06.228559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429d096a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ce7cabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ce7ca5e0>]}


============================== 18:41:06.236481 | 136c316b-3e90-499d-b783-4964beb2b85a ==============================
[0m18:41:06.236481 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:41:06.238033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:06.608261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136c316b-3e90-499d-b783-4964beb2b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ccf63ee0>]}
[0m18:41:06.704743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136c316b-3e90-499d-b783-4964beb2b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ce80eca0>]}
[0m18:41:06.708577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:41:06.738108 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:41:06.742178 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:41:06.743282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '136c316b-3e90-499d-b783-4964beb2b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ce8088e0>]}
[0m18:41:08.713032 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'raw.staging_reviews' which was not found
[0m18:41:08.715019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6003158, "process_user_time": 4.819441, "process_kernel_time": 0.324501, "process_mem_max_rss": "100912", "process_in_blocks": "2656", "command_success": false, "process_out_blocks": "0"}
[0m18:41:08.716218 [debug] [MainThread]: Command `dbt run` failed at 18:41:08.716032 after 2.60 seconds
[0m18:41:08.717180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429d096a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ccbf46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7429ccd32a00>]}
[0m18:41:08.718146 [debug] [MainThread]: Flushing usage events
[0m18:52:42.062476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cfe11520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099ce2bbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cdbb1910>]}


============================== 18:52:42.070320 | fa92fc9e-1504-452d-9016-c060a9d2726e ==============================
[0m18:52:42.070320 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:52:42.071896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:42.365981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa92fc9e-1504-452d-9016-c060a9d2726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cc2fd4f0>]}
[0m18:52:42.460963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa92fc9e-1504-452d-9016-c060a9d2726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099ce3f08e0>]}
[0m18:52:42.462285 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:52:42.488150 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:52:42.492836 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:52:42.494251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa92fc9e-1504-452d-9016-c060a9d2726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cc1f5880>]}
[0m18:52:44.302290 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'raw.staging_reviews' which was not found
[0m18:52:44.304207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3446238, "process_user_time": 4.677812, "process_kernel_time": 0.272105, "process_mem_max_rss": "100820", "process_out_blocks": "1680", "command_success": false, "process_in_blocks": "0"}
[0m18:52:44.305400 [debug] [MainThread]: Command `dbt run` failed at 18:52:44.305221 after 2.35 seconds
[0m18:52:44.306307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cfe11520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cc0c3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7099cc0ca490>]}
[0m18:52:44.307327 [debug] [MainThread]: Flushing usage events
[0m18:58:05.263275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e93a44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e72433a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e71c75e0>]}


============================== 18:58:05.275725 | 6493d336-80b5-4e99-9d25-ba5f77439df7 ==============================
[0m18:58:05.275725 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:58:05.277472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:05.595859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6493d336-80b5-4e99-9d25-ba5f77439df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e59348e0>]}
[0m18:58:05.705333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6493d336-80b5-4e99-9d25-ba5f77439df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e7fe9a60>]}
[0m18:58:05.707015 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:05.744885 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:58:05.754400 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:58:05.756049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6493d336-80b5-4e99-9d25-ba5f77439df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e582ab50>]}
[0m18:58:08.775249 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'raw.staging_reviews' which was not found
[0m18:58:08.777233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.620345, "process_user_time": 6.864136, "process_kernel_time": 0.44625, "process_mem_max_rss": "160836", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:08.778569 [debug] [MainThread]: Command `dbt run` failed at 18:58:08.778281 after 3.62 seconds
[0m18:58:08.779678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e93a44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e56248e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5e5765640>]}
[0m18:58:08.780851 [debug] [MainThread]: Flushing usage events
[0m18:58:43.581518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db5a4734f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db58498700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db584076a0>]}


============================== 18:58:43.594379 | c4eddfb7-0a85-45d6-846d-2461ddc7f26a ==============================
[0m18:58:43.594379 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:58:43.596185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:43.953238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4eddfb7-0a85-45d6-846d-2461ddc7f26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db56a65310>]}
[0m18:58:44.067702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4eddfb7-0a85-45d6-846d-2461ddc7f26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db5694db20>]}
[0m18:58:44.069628 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:44.102538 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:58:44.106264 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:58:44.107524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4eddfb7-0a85-45d6-846d-2461ddc7f26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db590b96d0>]}
[0m18:58:46.246391 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'raw.staging_reviews' which was not found
[0m18:58:46.250301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8233488, "process_user_time": 5.577677, "process_kernel_time": 0.23124, "process_mem_max_rss": "101168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:46.251877 [debug] [MainThread]: Command `dbt run` failed at 18:58:46.251622 after 2.83 seconds
[0m18:58:46.252831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db5a4734f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db566edb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db5682ab80>]}
[0m18:58:46.253714 [debug] [MainThread]: Flushing usage events
[0m19:06:47.852562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069afcde190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069adb42ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069adb0a670>]}


============================== 19:06:47.861539 | 07114fc3-961b-4007-9007-84e9b6a91a1c ==============================
[0m19:06:47.861539 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:06:47.863987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/dbt_project', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:06:48.096895 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'my_postgres_source', 'schema': 'raw', 'tables': [{'name': 'staging_reviews'}]}] is not of type 'object'

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:06:48.099911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39674827, "process_user_time": 3.451987, "process_kernel_time": 0.268621, "process_mem_max_rss": "160832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:48.101808 [debug] [MainThread]: Command `dbt run` failed at 19:06:48.101515 after 0.40 seconds
[0m19:06:48.103204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069afcde190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ac245250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ac245280>]}
[0m19:06:48.104819 [debug] [MainThread]: Flushing usage events
[0m19:07:10.060273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d780e5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d79997d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d76078b20>]}


============================== 19:07:10.068697 | 375649c7-f028-489f-be8c-7a1ba2907eaa ==============================
[0m19:07:10.068697 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:07:10.070110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:10.287959 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'my_postgres_source', 'schema': 'raw', 'tables': [{'name': 'staging_reviews'}]}] is not of type 'object'

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:07:10.290903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34651548, "process_user_time": 3.40389, "process_kernel_time": 0.240841, "process_mem_max_rss": "94244", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:07:10.292701 [debug] [MainThread]: Command `dbt run` failed at 19:07:10.292422 after 0.35 seconds
[0m19:07:10.294118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d780e5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d746d4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774d746d4970>]}
[0m19:07:10.295255 [debug] [MainThread]: Flushing usage events
[0m19:10:49.783223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc75003a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc55235e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc8765dc0>]}


============================== 19:10:49.798558 | e23d7da2-93d2-4ca7-a53f-791c2e5044db ==============================
[0m19:10:49.798558 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:10:49.800078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:10:50.153959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23d7da2-93d2-4ca7-a53f-791c2e5044db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc53137f0>]}
[0m19:10:50.272246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23d7da2-93d2-4ca7-a53f-791c2e5044db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc5b60760>]}
[0m19:10:50.273990 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:10:50.303315 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:10:50.309336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:10:50.311238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e23d7da2-93d2-4ca7-a53f-791c2e5044db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc3a20c10>]}
[0m19:10:52.659629 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:10:52.662163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0303693, "process_user_time": 6.221149, "process_kernel_time": 0.39182, "process_mem_max_rss": "101064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:10:52.663756 [debug] [MainThread]: Command `dbt run` failed at 19:10:52.663547 after 3.03 seconds
[0m19:10:52.664813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc75003a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc39cdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bc385ddc0>]}
[0m19:10:52.666113 [debug] [MainThread]: Flushing usage events
[0m19:13:04.567326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812efbf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812cfe25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76813072bdc0>]}


============================== 19:13:04.574847 | 6b789dda-5d67-47c0-a881-2fc92b1b2691 ==============================
[0m19:13:04.574847 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:13:04.576191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m19:13:04.811430 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'my_postgres_source', 'database': 'music_reviews', 'schema': 'raw', 'tables': [{'name': 'staging_reviews'}]}] is not of type 'object'

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:13:04.814178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3649397, "process_user_time": 2.711887, "process_kernel_time": 0.299987, "process_mem_max_rss": "94676", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:13:04.816797 [debug] [MainThread]: Command `dbt run` failed at 19:13:04.816045 after 0.37 seconds
[0m19:13:04.818988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812efbf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812b538430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812b538460>]}
[0m19:13:04.821218 [debug] [MainThread]: Flushing usage events
[0m19:20:05.146836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712474de93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712472e0c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71247600fdc0>]}


============================== 19:20:05.154761 | 7efa9542-65a1-44bb-9ca7-802d2e00537d ==============================
[0m19:20:05.154761 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:05.156503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m19:20:05.519202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7efa9542-65a1-44bb-9ca7-802d2e00537d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712472c879a0>]}
[0m19:20:05.636550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7efa9542-65a1-44bb-9ca7-802d2e00537d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124732df0d0>]}
[0m19:20:05.638228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:05.668507 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:20:05.673292 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:20:05.674711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7efa9542-65a1-44bb-9ca7-802d2e00537d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124712f38e0>]}
[0m19:20:08.344185 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:20:08.346537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.338762, "process_user_time": 6.476669, "process_kernel_time": 0.316815, "process_mem_max_rss": "100948", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:20:08.348348 [debug] [MainThread]: Command `dbt run` failed at 19:20:08.347963 after 3.34 seconds
[0m19:20:08.349406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712474de93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712471140a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712471146e80>]}
[0m19:20:08.350468 [debug] [MainThread]: Flushing usage events
[0m19:21:09.469271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d714b2c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d7129c53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d71294b5e0>]}


============================== 19:21:09.478110 | 9181a6a6-afb1-470a-875e-2b799dc11c70 ==============================
[0m19:21:09.478110 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:21:09.480628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:09.835573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9181a6a6-afb1-470a-875e-2b799dc11c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d712954df0>]}
[0m19:21:09.954119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9181a6a6-afb1-470a-875e-2b799dc11c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d713705d00>]}
[0m19:21:09.956460 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:21:09.994189 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:21:09.999510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:21:10.000773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9181a6a6-afb1-470a-875e-2b799dc11c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d71293f370>]}
[0m19:21:12.963525 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:21:12.966051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6222107, "process_user_time": 7.523811, "process_kernel_time": 0.441161, "process_mem_max_rss": "160836", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:21:12.968441 [debug] [MainThread]: Command `dbt run` failed at 19:21:12.967991 after 3.62 seconds
[0m19:21:12.970440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d714b2c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d710e81370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d710e8d5e0>]}
[0m19:21:12.972494 [debug] [MainThread]: Flushing usage events
[0m19:26:16.019211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77874cd954c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77874df60670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77874b9bb1c0>]}


============================== 19:26:16.027229 | 54d47396-131c-498e-a835-2a6ca16224a1 ==============================
[0m19:26:16.027229 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:26:16.029042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'log_path': '/home/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:26:16.230683 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'my_postgres_source', 'database': 'music_reviews', 'schema': 'raw', 'tables': [{'name': 'staging_reviews'}]}] is not of type 'object'

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:26:16.233270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.32148346, "process_user_time": 3.091608, "process_kernel_time": 0.23998, "process_mem_max_rss": "94176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:26:16.235475 [debug] [MainThread]: Command `dbt run` failed at 19:26:16.235138 after 0.32 seconds
[0m19:26:16.237068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77874cd954c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77874abb7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787493cc100>]}
[0m19:26:16.238530 [debug] [MainThread]: Flushing usage events
[0m19:26:44.074191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c0c9f5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c0aa574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c0a897820>]}


============================== 19:26:44.086295 | 40789821-13af-4024-89e8-7e71e05cff14 ==============================
[0m19:26:44.086295 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:26:44.088175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:44.367783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40789821-13af-4024-89e8-7e71e05cff14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08fb2550>]}
[0m19:26:44.463143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40789821-13af-4024-89e8-7e71e05cff14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08f9bf70>]}
[0m19:26:44.465000 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:26:44.501982 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:26:44.505699 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:26:44.507058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40789821-13af-4024-89e8-7e71e05cff14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08f2bf40>]}
[0m19:26:46.414032 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:26:46.416005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4640763, "process_user_time": 4.876857, "process_kernel_time": 0.244645, "process_mem_max_rss": "101008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:26:46.417358 [debug] [MainThread]: Command `dbt run` failed at 19:26:46.417164 after 2.47 seconds
[0m19:26:46.418189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c0c9f5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08f6bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08d84a60>]}
[0m19:26:46.419013 [debug] [MainThread]: Flushing usage events
[0m19:27:57.238040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e83f083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e81f6a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e8516bdc0>]}


============================== 19:27:57.247546 | ff9af1b1-a9e7-43b3-b6ce-bea7a3562662 ==============================
[0m19:27:57.247546 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:27:57.249110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:57.563573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff9af1b1-a9e7-43b3-b6ce-bea7a3562662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e80537e80>]}
[0m19:27:57.679851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff9af1b1-a9e7-43b3-b6ce-bea7a3562662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e8243d0d0>]}
[0m19:27:57.681587 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:27:57.717204 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:27:57.721780 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:27:57.722839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff9af1b1-a9e7-43b3-b6ce-bea7a3562662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e803c9910>]}
[0m19:27:59.921427 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:27:59.923379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8350744, "process_user_time": 5.218681, "process_kernel_time": 0.295698, "process_mem_max_rss": "101016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:27:59.924723 [debug] [MainThread]: Command `dbt run` failed at 19:27:59.924553 after 2.84 seconds
[0m19:27:59.925616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e83f083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e82bc1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e8030ab50>]}
[0m19:27:59.926434 [debug] [MainThread]: Flushing usage events
[0m19:29:32.335870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74388598e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743886b45670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438845a71c0>]}


============================== 19:29:32.344310 | 518e94c3-b8b7-4112-b841-e7a6539c70bb ==============================
[0m19:29:32.344310 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:29:32.346159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m19:29:32.597166 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['version']: '2' is not valid under any of the given schemas

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:29:32.599891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38472846, "process_user_time": 3.044094, "process_kernel_time": 0.164005, "process_mem_max_rss": "95796", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:29:32.601283 [debug] [MainThread]: Command `dbt run` failed at 19:29:32.601107 after 0.39 seconds
[0m19:29:32.602071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74388598e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74388570faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743881ea6be0>]}
[0m19:29:32.603005 [debug] [MainThread]: Flushing usage events
[0m19:29:50.946589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7f2974f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7d2bc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7d0fd820>]}


============================== 19:29:50.955317 | efc647cf-1a4b-4653-a273-6ca291ce4a16 ==============================
[0m19:29:50.955317 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:29:50.957208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:29:51.233075 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['version']: '1' is not valid under any of the given schemas

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:29:51.235341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.43989936, "process_user_time": 3.053149, "process_kernel_time": 0.236398, "process_mem_max_rss": "95524", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:29:51.237044 [debug] [MainThread]: Command `dbt run` failed at 19:29:51.236726 after 0.44 seconds
[0m19:29:51.238148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7f2974f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7b7ae6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731b7b7aee50>]}
[0m19:29:51.239455 [debug] [MainThread]: Flushing usage events
[0m19:41:20.413307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da599a3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da57937280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da57937520>]}


============================== 19:41:20.420627 | 319b632b-fd69-48c5-9e6b-80b655dc8a29 ==============================
[0m19:41:20.420627 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:20.421659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:41:20.639022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319b632b-fd69-48c5-9e6b-80b655dc8a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da55f275b0>]}
[0m19:41:20.708286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319b632b-fd69-48c5-9e6b-80b655dc8a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da57c9eac0>]}
[0m19:41:20.709732 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:20.729553 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:41:20.734329 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:41:20.735335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '319b632b-fd69-48c5-9e6b-80b655dc8a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da55e9b7c0>]}
[0m19:41:22.178377 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.music_reviews.staging_reviews' (models/staging/staging_reviews.sql) depends on a source named 'my_postgres_source.staging_reviews' which was not found
[0m19:41:22.180021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8499384, "process_user_time": 3.564258, "process_kernel_time": 0.244291, "process_mem_max_rss": "100496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:22.181441 [debug] [MainThread]: Command `dbt run` failed at 19:41:22.181225 after 1.85 seconds
[0m19:41:22.182421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da599a3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da55e6d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71da55cf2a90>]}
[0m19:41:22.183366 [debug] [MainThread]: Flushing usage events
[0m19:42:29.675764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd40295b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd403c01d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd40092db20>]}


============================== 19:42:29.681660 | 37a5cc26-6a9e-4a93-be69-1c031c79a305 ==============================
[0m19:42:29.681660 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:42:29.682788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:42:29.804288 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'my_postgres_source', 'database': 'music_reviews', 'schema': 'raw', 'tables': [{'name': 'staging_reviews'}]}] is not of type 'object'

Error encountered in /home/airflow/dbt_project/dbt_project.yml
[0m19:42:29.805783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2181202, "process_user_time": 1.87976, "process_kernel_time": 0.128805, "process_mem_max_rss": "94492", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:29.806774 [debug] [MainThread]: Command `dbt run` failed at 19:42:29.806615 after 0.22 seconds
[0m19:42:29.807409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd40295b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd3fef85a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd3fef85970>]}
[0m19:42:29.808091 [debug] [MainThread]: Flushing usage events
[0m19:48:13.814623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e99bca520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e9ae32d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e97b5eb20>]}


============================== 19:48:13.822359 | 91982b92-bd31-4626-a558-89af51f941f4 ==============================
[0m19:48:13.822359 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:48:13.823366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:48:14.025214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e9614a8e0>]}
[0m19:48:14.095212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e96180dc0>]}
[0m19:48:14.096591 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:14.116458 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:48:14.119687 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:48:14.120612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e960b2940>]}
[0m19:48:15.930367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e94d72f40>]}
[0m19:48:16.112922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e94cad0a0>]}
[0m19:48:16.114436 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:48:16.115332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91982b92-bd31-4626-a558-89af51f941f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e94d6ae20>]}
[0m19:48:16.117957 [info ] [MainThread]: 
[0m19:48:16.119510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:16.126708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:48:16.206523 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:48:16.207477 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:48:16.208192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:16.210319 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:48:16.211954 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:48:16.212954 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:48:16.213840 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:48:16.214537 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:48:16.215383 [debug] [ThreadPool]: On list_music_reviews: No close available on handle
[0m19:48:16.216724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:16.217522 [debug] [MainThread]: Connection 'list_music_reviews' was properly closed.
[0m19:48:16.218385 [info ] [MainThread]: 
[0m19:48:16.219318 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m19:48:16.220651 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m19:48:16.222793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4960647, "process_user_time": 4.005258, "process_kernel_time": 0.323133, "process_mem_max_rss": "108292", "process_in_blocks": "1296", "command_success": false, "process_out_blocks": "0"}
[0m19:48:16.223954 [debug] [MainThread]: Command `dbt run` failed at 19:48:16.223763 after 2.50 seconds
[0m19:48:16.224626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e99bca520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e9440a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747e94c7cee0>]}
[0m19:48:16.225335 [debug] [MainThread]: Flushing usage events
[0m19:48:57.033601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d564004a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d561e11700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d561e11fa0>]}


============================== 19:48:57.041878 | c110218d-4872-4ad4-82a0-8dd479a08966 ==============================
[0m19:48:57.041878 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:48:57.042911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:48:57.298858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c110218d-4872-4ad4-82a0-8dd479a08966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d561e11970>]}
[0m19:48:57.389302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c110218d-4872-4ad4-82a0-8dd479a08966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d5623b5730>]}
[0m19:48:57.390762 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:57.420011 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:48:57.762491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:57.763762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:57.832172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c110218d-4872-4ad4-82a0-8dd479a08966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d5602dcc70>]}
[0m19:48:58.012202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c110218d-4872-4ad4-82a0-8dd479a08966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d56020d8b0>]}
[0m19:48:58.013898 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:48:58.015034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c110218d-4872-4ad4-82a0-8dd479a08966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d560387d30>]}
[0m19:48:58.018595 [info ] [MainThread]: 
[0m19:48:58.020843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:58.032097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:48:58.106459 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:48:58.107437 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:48:58.108122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:58.112977 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:48:58.118472 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:48:58.119792 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:48:58.120751 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:48:58.121785 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:48:58.122848 [debug] [ThreadPool]: On list_music_reviews: No close available on handle
[0m19:48:58.124527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:58.125295 [debug] [MainThread]: Connection 'list_music_reviews' was properly closed.
[0m19:48:58.126028 [info ] [MainThread]: 
[0m19:48:58.126950 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m19:48:58.128375 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m19:48:58.130881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2006165, "process_user_time": 3.091931, "process_kernel_time": 0.29561, "process_mem_max_rss": "160844", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:48:58.132455 [debug] [MainThread]: Command `dbt run` failed at 19:48:58.132160 after 1.20 seconds
[0m19:48:58.133550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d564004a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d55f9f7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d55f9e5c70>]}
[0m19:48:58.134720 [debug] [MainThread]: Flushing usage events
[0m19:50:26.783581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d72e4ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d70db54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d70e43460>]}


============================== 19:50:26.804176 | aa929b14-2d31-4b9c-a470-a41dbf34ddb5 ==============================
[0m19:50:26.804176 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:26.805286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'log_path': '/home/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:27.060953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa929b14-2d31-4b9c-a470-a41dbf34ddb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6f405e50>]}
[0m19:50:27.144292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa929b14-2d31-4b9c-a470-a41dbf34ddb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d72b87e80>]}
[0m19:50:27.145782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:50:27.174015 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:27.517810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:27.518927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:27.579702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa929b14-2d31-4b9c-a470-a41dbf34ddb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6f14dca0>]}
[0m19:50:27.770529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa929b14-2d31-4b9c-a470-a41dbf34ddb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6f03f910>]}
[0m19:50:27.771800 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:50:27.772738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa929b14-2d31-4b9c-a470-a41dbf34ddb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6f15a430>]}
[0m19:50:27.775277 [info ] [MainThread]: 
[0m19:50:27.776786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:27.790321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:50:27.868462 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:50:27.869414 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:50:27.870210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:27.872002 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:50:27.873355 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:50:27.874168 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:50:27.875007 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:50:27.875887 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:50:27.877039 [debug] [ThreadPool]: On list_music_reviews: No close available on handle
[0m19:50:27.878489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:27.879325 [debug] [MainThread]: Connection 'list_music_reviews' was properly closed.
[0m19:50:27.880212 [info ] [MainThread]: 
[0m19:50:27.881359 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m19:50:27.883129 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m19:50:27.884914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1973743, "process_user_time": 3.018144, "process_kernel_time": 1.082203, "process_mem_max_rss": "160832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:50:27.886186 [debug] [MainThread]: Command `dbt run` failed at 19:50:27.886032 after 1.20 seconds
[0m19:50:27.887020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d72e4ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6e828790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4d6f06c160>]}
[0m19:50:27.887728 [debug] [MainThread]: Flushing usage events
[0m19:51:27.232068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd50884d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd509ab3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5067dfb20>]}


============================== 19:51:27.238260 | fb5cd231-7251-434d-b98a-4414149163f8 ==============================
[0m19:51:27.238260 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:51:27.239149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:27.430235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5cd231-7251-434d-b98a-4414149163f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd504ddb8e0>]}
[0m19:51:27.497837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb5cd231-7251-434d-b98a-4414149163f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd504dfadc0>]}
[0m19:51:27.499308 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:51:27.519755 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:51:27.773746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:27.774609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:27.823176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb5cd231-7251-434d-b98a-4414149163f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd504afad60>]}
[0m19:51:27.970031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb5cd231-7251-434d-b98a-4414149163f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd504a6c9d0>]}
[0m19:51:27.970984 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:51:27.971733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5cd231-7251-434d-b98a-4414149163f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd504b0f190>]}
[0m19:51:27.974320 [info ] [MainThread]: 
[0m19:51:27.975937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:27.982418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:51:28.028493 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:51:28.029392 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:51:28.030099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:28.031653 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:51:28.032743 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:51:28.033376 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:51:28.034267 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:51:28.034876 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:51:28.035520 [debug] [ThreadPool]: On list_music_reviews: No close available on handle
[0m19:51:28.036661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:28.037227 [debug] [MainThread]: Connection 'list_music_reviews' was properly closed.
[0m19:51:28.037880 [info ] [MainThread]: 
[0m19:51:28.038651 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m19:51:28.039709 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m19:51:28.041640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8858122, "process_user_time": 2.420641, "process_kernel_time": 0.164043, "process_mem_max_rss": "104368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:51:28.043076 [debug] [MainThread]: Command `dbt run` failed at 19:51:28.042867 after 0.89 seconds
[0m19:51:28.043787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd50884d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5042526d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5042438b0>]}
[0m19:51:28.044492 [debug] [MainThread]: Flushing usage events
[0m19:53:04.978193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282dd75520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282efdcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282bd08b20>]}


============================== 19:53:04.985734 | 2da4dba3-631d-4955-a3f8-b6b460420de9 ==============================
[0m19:53:04.985734 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:53:04.986856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'log_path': '/home/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:05.193097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282a2f48e0>]}
[0m19:53:05.258684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282a322dc0>]}
[0m19:53:05.260381 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:53:05.287792 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:53:05.432660 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:53:05.434144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282c9a8580>]}
[0m19:53:06.878590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772828edfe50>]}
[0m19:53:07.012652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772828ddd940>]}
[0m19:53:07.013577 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:53:07.014354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2da4dba3-631d-4955-a3f8-b6b460420de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772828e9dcd0>]}
[0m19:53:07.017272 [info ] [MainThread]: 
[0m19:53:07.018688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:07.025134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:53:07.067260 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:53:07.068121 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:53:07.068765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:07.070415 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m19:53:07.071866 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:53:07.072884 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:53:07.073536 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:53:07.074128 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:53:07.074780 [debug] [ThreadPool]: On list_music_reviews: No close available on handle
[0m19:53:07.075906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:07.076658 [debug] [MainThread]: Connection 'list_music_reviews' was properly closed.
[0m19:53:07.077267 [info ] [MainThread]: 
[0m19:53:07.077947 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m19:53:07.079081 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m19:53:07.081548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.196295, "process_user_time": 3.673001, "process_kernel_time": 0.224305, "process_mem_max_rss": "108956", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:07.082804 [debug] [MainThread]: Command `dbt run` failed at 19:53:07.082657 after 2.20 seconds
[0m19:53:07.083469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77282dd75520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772828e9dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728285a4c10>]}
[0m19:53:07.084198 [debug] [MainThread]: Flushing usage events
[0m19:59:56.832998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abfd43460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ac0ecac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abe9661c0>]}


============================== 19:59:56.839200 | d837713f-7515-435f-bfdb-3e168994bdc9 ==============================
[0m19:59:56.839200 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:59:56.840161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m19:59:57.051191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abc2bf820>]}
[0m19:59:57.125072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abee60130>]}
[0m19:59:57.126727 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:59:57.163367 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:59:57.338984 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:59:57.340249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abe974400>]}
[0m19:59:58.811198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abaea9e80>]}
[0m19:59:58.950505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abade6970>]}
[0m19:59:58.951408 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m19:59:58.952443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abae69c10>]}
[0m19:59:58.955027 [info ] [MainThread]: 
[0m19:59:58.956486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:58.964827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m19:59:59.046289 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m19:59:59.047175 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m19:59:59.047887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:59.073680 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.026 seconds
[0m19:59:59.076419 [debug] [ThreadPool]: On list_music_reviews: Close
[0m19:59:59.078950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m19:59:59.087395 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m19:59:59.088192 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m19:59:59.088841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:59.106628 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:59:59.107741 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m19:59:59.108503 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:59:59.128785 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m19:59:59.130493 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m19:59:59.131460 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m19:59:59.138542 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.139572 [debug] [MainThread]: On master: BEGIN
[0m19:59:59.140342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:59.148343 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:59:59.149361 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.150192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:59:59.185521 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m19:59:59.187549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735aba2bbc10>]}
[0m19:59:59.188545 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:59.190296 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.191170 [debug] [MainThread]: On master: BEGIN
[0m19:59:59.192423 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:59:59.193437 [debug] [MainThread]: On master: COMMIT
[0m19:59:59.194408 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.195447 [debug] [MainThread]: On master: COMMIT
[0m19:59:59.196916 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:59.197909 [debug] [MainThread]: On master: Close
[0m19:59:59.199072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:59.202247 [info ] [MainThread]: 
[0m19:59:59.213405 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m19:59:59.214564 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m19:59:59.215544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m19:59:59.216488 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m19:59:59.230429 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m19:59:59.251025 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m19:59:59.311628 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m19:59:59.329201 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.330628 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m19:59:59.331927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:59.351331 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m19:59:59.352605 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.353803 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m19:59:59.474745 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.120 seconds
[0m19:59:59.482172 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.482834 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m19:59:59.484029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:59.488435 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.489352 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m19:59:59.490452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:59:59.515907 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m19:59:59.516748 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.517431 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m19:59:59.543140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m19:59:59.551987 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m19:59:59.557465 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m19:59:59.558267 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m19:59:59.562463 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m19:59:59.565657 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m19:59:59.567811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abfb73be0>]}
[0m19:59:59.568920 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.35s]
[0m19:59:59.570147 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m19:59:59.572483 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m19:59:59.573700 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m19:59:59.574697 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m19:59:59.575601 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m19:59:59.580818 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m19:59:59.592673 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m19:59:59.598293 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m19:59:59.610790 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m19:59:59.611710 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m19:59:59.612407 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:59:59.621470 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:59:59.622549 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m19:59:59.623379 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

reviews as (
    select distinct
        asin,
        helpful,
        reviewerText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m19:59:59.625464 [debug] [Thread-3  ]: Postgres adapter: Postgres error: WITH query name "reviews" specified more than once
LINE 32: reviews as (
         ^

[0m19:59:59.626623 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: ROLLBACK
[0m19:59:59.627800 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m19:59:59.636336 [debug] [Thread-3  ]: Database Error in model normalized_reviews (models/core/normalized_reviews.sql)
  WITH query name "reviews" specified more than once
  LINE 32: reviews as (
           ^
  compiled code at target/run/music_reviews/models/core/normalized_reviews.sql
[0m19:59:59.637641 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd837713f-7515-435f-bfdb-3e168994bdc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735aba1db430>]}
[0m19:59:59.639195 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model raw.normalized_reviews ................... [[31mERROR[0m in 0.06s]
[0m19:59:59.641016 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m19:59:59.643973 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m19:59:59.645167 [info ] [Thread-2  ]: 3 of 3 SKIP relation raw.reviews_summary ....................................... [[33mSKIP[0m]
[0m19:59:59.646210 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m19:59:59.648946 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.649590 [debug] [MainThread]: On master: BEGIN
[0m19:59:59.650182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:59.660607 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:59:59.661523 [debug] [MainThread]: On master: COMMIT
[0m19:59:59.662208 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:59.662742 [debug] [MainThread]: On master: COMMIT
[0m19:59:59.663477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:59.664315 [debug] [MainThread]: On master: Close
[0m19:59:59.665382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:59.666267 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m19:59:59.666969 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m19:59:59.667759 [info ] [MainThread]: 
[0m19:59:59.669255 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m19:59:59.671417 [debug] [MainThread]: Command end result
[0m19:59:59.735052 [info ] [MainThread]: 
[0m19:59:59.736213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:59:59.737333 [info ] [MainThread]: 
[0m19:59:59.738650 [error] [MainThread]:   Database Error in model normalized_reviews (models/core/normalized_reviews.sql)
  WITH query name "reviews" specified more than once
  LINE 32: reviews as (
           ^
  compiled code at target/run/music_reviews/models/core/normalized_reviews.sql
[0m19:59:59.740512 [info ] [MainThread]: 
[0m19:59:59.742777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m19:59:59.745337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9966688, "process_user_time": 3.928341, "process_kernel_time": 0.34697, "process_mem_max_rss": "113776", "process_in_blocks": "416", "command_success": false, "process_out_blocks": "0"}
[0m19:59:59.746641 [debug] [MainThread]: Command `dbt run` failed at 19:59:59.746509 after 3.00 seconds
[0m19:59:59.747474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abfd43460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abf9f9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735abc323790>]}
[0m19:59:59.748695 [debug] [MainThread]: Flushing usage events
[0m20:01:15.620923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc68c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc4856280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc4856520>]}


============================== 20:01:15.628288 | 1aebcad1-84d4-4151-a32f-25e870c131c6 ==============================
[0m20:01:15.628288 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:01:15.629064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:01:15.815356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc5a27ee0>]}
[0m20:01:15.879809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc46e3eb0>]}
[0m20:01:15.881247 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:01:15.901566 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:01:16.164749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:01:16.165881 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/core/normalized_reviews.sql
[0m20:01:16.458173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1c75d30>]}
[0m20:01:16.589109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1b88df0>]}
[0m20:01:16.590126 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:01:16.591121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1be3c70>]}
[0m20:01:16.593869 [info ] [MainThread]: 
[0m20:01:16.595666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:16.602167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:01:16.643494 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:01:16.644338 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:01:16.645062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:16.655488 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m20:01:16.657438 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:01:16.659594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:01:16.666806 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:01:16.667512 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:01:16.668034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:16.675741 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:01:16.676605 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:01:16.677409 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:01:16.681655 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:01:16.683411 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:01:16.684287 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:01:16.689644 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:16.690347 [debug] [MainThread]: On master: BEGIN
[0m20:01:16.690881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:16.699100 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:01:16.700005 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:16.701010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:01:16.724627 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m20:01:16.726868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc10fbfa0>]}
[0m20:01:16.727701 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:16.728668 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:16.729319 [debug] [MainThread]: On master: BEGIN
[0m20:01:16.730461 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:01:16.731328 [debug] [MainThread]: On master: COMMIT
[0m20:01:16.732138 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:16.732770 [debug] [MainThread]: On master: COMMIT
[0m20:01:16.733522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:01:16.734135 [debug] [MainThread]: On master: Close
[0m20:01:16.735085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:01:16.735931 [info ] [MainThread]: 
[0m20:01:16.747035 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:01:16.748416 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:01:16.749509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:01:16.750580 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:01:16.763121 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:01:16.771126 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:01:16.876952 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:01:16.887235 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:16.888043 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:01:16.888697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:01:16.896550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:01:16.897444 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:16.898174 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:01:16.942754 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.044 seconds
[0m20:01:16.950722 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:16.951866 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:01:16.953532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:01:16.958095 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:16.959053 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:01:16.960394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:01:16.984888 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:01:16.985852 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:16.986575 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:01:17.019711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.032 seconds
[0m20:01:17.027095 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:01:17.032776 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:01:17.033682 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:01:17.037636 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:01:17.040680 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:01:17.042852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1064790>]}
[0m20:01:17.044185 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.29s]
[0m20:01:17.045531 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:01:17.047771 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:01:17.048721 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:01:17.049904 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:01:17.050842 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:01:17.055057 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:01:17.062774 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:01:17.068875 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:01:17.076575 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:01:17.077371 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:01:17.077978 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:01:17.086010 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m20:01:17.087020 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:01:17.087924 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewerText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:01:17.089607 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "reviewertext" does not exist
LINE 20:         reviewerText,
                 ^
HINT:  Perhaps you meant to reference the column "base.reviewtext".

[0m20:01:17.090885 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: ROLLBACK
[0m20:01:17.092188 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:01:17.095436 [debug] [Thread-3  ]: Database Error in model normalized_reviews (models/core/normalized_reviews.sql)
  column "reviewertext" does not exist
  LINE 20:         reviewerText,
                   ^
  HINT:  Perhaps you meant to reference the column "base.reviewtext".
  compiled code at target/run/music_reviews/models/core/normalized_reviews.sql
[0m20:01:17.096408 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aebcad1-84d4-4151-a32f-25e870c131c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1064250>]}
[0m20:01:17.097422 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model raw.normalized_reviews ................... [[31mERROR[0m in 0.05s]
[0m20:01:17.099398 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:01:17.101580 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:01:17.102800 [info ] [Thread-2  ]: 3 of 3 SKIP relation raw.reviews_summary ....................................... [[33mSKIP[0m]
[0m20:01:17.104088 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:01:17.108032 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:17.109498 [debug] [MainThread]: On master: BEGIN
[0m20:01:17.110236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:17.119719 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:01:17.120863 [debug] [MainThread]: On master: COMMIT
[0m20:01:17.121557 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:17.122320 [debug] [MainThread]: On master: COMMIT
[0m20:01:17.123251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:01:17.124423 [debug] [MainThread]: On master: Close
[0m20:01:17.126154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:17.127440 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:01:17.128302 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:01:17.129210 [info ] [MainThread]: 
[0m20:01:17.130490 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:01:17.133273 [debug] [MainThread]: Command end result
[0m20:01:17.204035 [info ] [MainThread]: 
[0m20:01:17.205277 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:01:17.206881 [info ] [MainThread]: 
[0m20:01:17.209222 [error] [MainThread]:   Database Error in model normalized_reviews (models/core/normalized_reviews.sql)
  column "reviewertext" does not exist
  LINE 20:         reviewerText,
                   ^
  HINT:  Perhaps you meant to reference the column "base.reviewtext".
  compiled code at target/run/music_reviews/models/core/normalized_reviews.sql
[0m20:01:17.211019 [info ] [MainThread]: 
[0m20:01:17.212571 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m20:01:17.214789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.662795, "process_user_time": 2.912241, "process_kernel_time": 0.224018, "process_mem_max_rss": "112328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:01:17.215906 [debug] [MainThread]: Command `dbt run` failed at 20:01:17.215776 after 1.66 seconds
[0m20:01:17.216761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc68c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc5a27ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0cc1b88df0>]}
[0m20:01:17.217748 [debug] [MainThread]: Flushing usage events
[0m20:02:16.195007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc38a6e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc36a03280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc36a03520>]}


============================== 20:02:16.200469 | 8fd9c30e-34bb-42f9-8c0b-89de73b9b73a ==============================
[0m20:02:16.200469 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:02:16.201308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:02:16.382940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc37b93ee0>]}
[0m20:02:16.449094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc36890eb0>]}
[0m20:02:16.450561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:02:16.478078 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:02:16.723140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:16.724288 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/core/normalized_reviews.sql
[0m20:02:17.024168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2fbe9d60>]}
[0m20:02:17.166603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2fafedf0>]}
[0m20:02:17.167691 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:02:17.168870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2fb63c70>]}
[0m20:02:17.171645 [info ] [MainThread]: 
[0m20:02:17.173428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:17.179756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:02:17.221466 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:02:17.222336 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:02:17.223018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:17.233239 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m20:02:17.235271 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:02:17.237306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:02:17.244231 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:02:17.244878 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:02:17.245404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:17.253321 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:02:17.254177 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:02:17.254781 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:02:17.258564 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:02:17.260408 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:02:17.261160 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:02:17.267160 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.268004 [debug] [MainThread]: On master: BEGIN
[0m20:02:17.268551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:17.277907 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:02:17.278921 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.280102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:17.303773 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m20:02:17.305581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2f072fa0>]}
[0m20:02:17.306401 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:17.307319 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.308298 [debug] [MainThread]: On master: BEGIN
[0m20:02:17.309675 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:02:17.310732 [debug] [MainThread]: On master: COMMIT
[0m20:02:17.311655 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.312271 [debug] [MainThread]: On master: COMMIT
[0m20:02:17.313562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:17.314802 [debug] [MainThread]: On master: Close
[0m20:02:17.316007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:02:17.316802 [info ] [MainThread]: 
[0m20:02:17.326802 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:02:17.327803 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:02:17.328969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:02:17.330221 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:02:17.342426 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:02:17.350811 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:02:17.452453 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:02:17.460826 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.461522 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:02:17.462230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:17.469700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:02:17.470529 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.471262 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:02:17.507651 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.035 seconds
[0m20:02:17.517676 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.518715 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:02:17.519975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:02:17.525606 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.526877 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:02:17.528136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:02:17.551831 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:02:17.552776 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.553529 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:02:17.555782 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:02:17.563477 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:02:17.568821 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:02:17.569704 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:02:17.573757 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:02:17.577095 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:02:17.579187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2efda760>]}
[0m20:02:17.580326 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.25s]
[0m20:02:17.581551 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:02:17.583573 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:02:17.584633 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:02:17.585795 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:02:17.586604 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:02:17.590915 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:02:17.597746 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:02:17.604624 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:02:17.611277 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:02:17.612161 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:02:17.612826 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:02:17.621287 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m20:02:17.622169 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:02:17.622945 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:02:17.746070 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.122 seconds
[0m20:02:17.750536 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:02:17.751389 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:02:17.752378 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:02:17.754362 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:02:17.754979 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:02:17.755619 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:02:17.763868 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m20:02:17.767868 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:02:17.769190 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:02:17.769900 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:02:17.770943 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:02:17.772707 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:02:17.773662 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2efda280>]}
[0m20:02:17.774683 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.19s]
[0m20:02:17.775914 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:02:17.777717 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:02:17.778597 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:02:17.779862 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:02:17.780851 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:02:17.784925 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:02:17.794762 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:02:17.816938 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:02:17.830728 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:02:17.831484 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:02:17.832094 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:02:17.841076 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m20:02:17.842210 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:02:17.843076 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:02:17.844607 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function avg(text) does not exist
LINE 10:     avg(overall) as avg_overall,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:02:17.845691 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:02:17.846804 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:02:17.849776 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function avg(text) does not exist
  LINE 10:     avg(overall) as avg_overall,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:02:17.851021 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd9c30e-34bb-42f9-8c0b-89de73b9b73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc34d1d2b0>]}
[0m20:02:17.852207 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.07s]
[0m20:02:17.853699 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:02:17.856792 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.857714 [debug] [MainThread]: On master: BEGIN
[0m20:02:17.858911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:17.869201 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:02:17.870122 [debug] [MainThread]: On master: COMMIT
[0m20:02:17.870814 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:17.871418 [debug] [MainThread]: On master: COMMIT
[0m20:02:17.872247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:17.872857 [debug] [MainThread]: On master: Close
[0m20:02:17.873758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:17.874897 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:02:17.877028 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:02:17.877800 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:02:17.878596 [info ] [MainThread]: 
[0m20:02:17.879587 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m20:02:17.881456 [debug] [MainThread]: Command end result
[0m20:02:17.942343 [info ] [MainThread]: 
[0m20:02:17.944436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:02:17.945741 [info ] [MainThread]: 
[0m20:02:17.947202 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function avg(text) does not exist
  LINE 10:     avg(overall) as avg_overall,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:02:17.948898 [info ] [MainThread]: 
[0m20:02:17.950219 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:02:17.952633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8312021, "process_user_time": 2.906013, "process_kernel_time": 0.217456, "process_mem_max_rss": "112936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:02:17.953706 [debug] [MainThread]: Command `dbt run` failed at 20:02:17.953537 after 1.83 seconds
[0m20:02:17.954376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc38a6e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc2fafeeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bc376a33d0>]}
[0m20:02:17.955013 [debug] [MainThread]: Flushing usage events
[0m20:03:49.666281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f87891c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f675d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f675d520>]}


============================== 20:03:49.672598 | bc83a56b-0e35-4616-97aa-249a44e43844 ==============================
[0m20:03:49.672598 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:03:49.673647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m20:03:49.906401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f78edee0>]}
[0m20:03:49.973033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f65eaeb0>]}
[0m20:03:49.974263 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:03:49.996811 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:03:50.265005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:50.265849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:50.311298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f4a75d00>]}
[0m20:03:50.465349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f49e7940>]}
[0m20:03:50.466721 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:03:50.467760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f4a83550>]}
[0m20:03:50.470896 [info ] [MainThread]: 
[0m20:03:50.472612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:03:50.480329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:03:50.534159 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:03:50.535206 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:03:50.536033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:50.549023 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.013 seconds
[0m20:03:50.551261 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:03:50.553713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:03:50.562856 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:03:50.563711 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:03:50.564389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:50.574456 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:03:50.575679 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:03:50.576541 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:03:50.580675 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:03:50.582742 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:03:50.583541 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:03:50.590941 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.592241 [debug] [MainThread]: On master: BEGIN
[0m20:03:50.593200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:50.604614 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:03:50.605887 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.606801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:03:50.636577 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m20:03:50.638905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f49e7b20>]}
[0m20:03:50.639897 [debug] [MainThread]: On master: ROLLBACK
[0m20:03:50.640935 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.641705 [debug] [MainThread]: On master: BEGIN
[0m20:03:50.643827 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:03:50.645087 [debug] [MainThread]: On master: COMMIT
[0m20:03:50.645982 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:50.646797 [debug] [MainThread]: On master: COMMIT
[0m20:03:50.647885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:03:50.648949 [debug] [MainThread]: On master: Close
[0m20:03:50.650237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:50.651350 [info ] [MainThread]: 
[0m20:03:50.663182 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:03:50.664447 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:03:50.665500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:03:50.666353 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:03:50.680030 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:03:50.688523 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:03:50.745320 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:03:50.754867 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.755674 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:03:50.756336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:50.765364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:03:50.766440 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.767328 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:03:50.847627 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.079 seconds
[0m20:03:50.855830 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.856657 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:03:50.857933 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:50.863598 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.864586 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:03:50.865897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:50.894012 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:03:50.895159 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.896119 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:03:50.912906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m20:03:50.922110 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:03:50.928429 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:03:50.929338 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:03:50.934679 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:03:50.938406 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:03:50.940923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336efe8efd0>]}
[0m20:03:50.942331 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.27s]
[0m20:03:50.943662 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:03:50.945487 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:03:50.946811 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:03:50.948021 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:03:50.949065 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:03:50.953903 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:03:50.962130 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:03:50.968271 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:03:50.976914 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:50.977690 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:03:50.978268 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:03:50.987173 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:03:50.988187 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:50.989057 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:03:51.167203 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.177 seconds
[0m20:03:51.171986 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:51.173039 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:03:51.175828 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:51.180652 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:51.181551 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:03:51.300480 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.118 seconds
[0m20:03:51.303333 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:03:51.304171 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:51.304860 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:03:51.306850 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:03:51.311899 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:03:51.313607 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:03:51.314492 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:03:51.319009 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:03:51.321298 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:03:51.322318 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336efc836a0>]}
[0m20:03:51.323492 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.37s]
[0m20:03:51.324955 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:03:51.327618 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:03:51.329296 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:03:51.330449 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:03:51.331622 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:03:51.391623 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:03:51.400509 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:03:51.425773 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:03:51.434632 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:03:51.435478 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:03:51.436081 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:03:51.444145 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m20:03:51.445144 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:03:51.446020 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:03:51.447652 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function avg(text) does not exist
LINE 10:     avg(overall) as avg_overall,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:03:51.448624 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:03:51.449827 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:03:51.453835 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function avg(text) does not exist
  LINE 10:     avg(overall) as avg_overall,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:03:51.455041 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83a56b-0e35-4616-97aa-249a44e43844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336efe31fa0>]}
[0m20:03:51.456210 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.12s]
[0m20:03:51.458669 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:03:51.461933 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:51.462851 [debug] [MainThread]: On master: BEGIN
[0m20:03:51.463579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:51.473989 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:03:51.476267 [debug] [MainThread]: On master: COMMIT
[0m20:03:51.477932 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:51.479128 [debug] [MainThread]: On master: COMMIT
[0m20:03:51.480183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:03:51.480939 [debug] [MainThread]: On master: Close
[0m20:03:51.481896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:51.482781 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:03:51.483443 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:03:51.484161 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:03:51.485205 [info ] [MainThread]: 
[0m20:03:51.486148 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m20:03:51.488619 [debug] [MainThread]: Command end result
[0m20:03:51.557586 [info ] [MainThread]: 
[0m20:03:51.559249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:51.561347 [info ] [MainThread]: 
[0m20:03:51.562883 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function avg(text) does not exist
  LINE 10:     avg(overall) as avg_overall,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:03:51.564207 [info ] [MainThread]: 
[0m20:03:51.565662 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:03:51.567642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9982638, "process_user_time": 3.026769, "process_kernel_time": 0.277012, "process_mem_max_rss": "108820", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:03:51.569416 [debug] [MainThread]: Command `dbt run` failed at 20:03:51.569100 after 2.00 seconds
[0m20:03:51.570688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f87891c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f4a75ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336f49fc2b0>]}
[0m20:03:51.571576 [debug] [MainThread]: Flushing usage events
[0m20:04:23.287684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b48be460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b2721ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b26d9670>]}


============================== 20:04:23.297233 | 79bd7069-6372-4370-a59c-e9609a1b49da ==============================
[0m20:04:23.297233 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:04:23.298292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:23.554951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b26d9d30>]}
[0m20:04:23.640570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b2761910>]}
[0m20:04:23.642193 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:04:23.668954 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:04:23.994075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:23.995524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:24.071703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b0baacd0>]}
[0m20:04:24.280500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b0adc910>]}
[0m20:04:24.281671 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:04:24.282966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b0bb8520>]}
[0m20:04:24.286343 [info ] [MainThread]: 
[0m20:04:24.288266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:24.296746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:04:24.361372 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:04:24.362378 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:04:24.363082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:24.374461 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m20:04:24.376981 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:04:24.379726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:04:24.389420 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:04:24.390333 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:04:24.390968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:24.400780 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:04:24.402187 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:04:24.403452 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:04:24.408430 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m20:04:24.411613 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:04:24.413186 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:04:24.425139 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.426786 [debug] [MainThread]: On master: BEGIN
[0m20:04:24.428723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:24.440777 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:04:24.441996 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.443359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:24.477354 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m20:04:24.484179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b0adcaf0>]}
[0m20:04:24.485949 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:24.486965 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.487794 [debug] [MainThread]: On master: BEGIN
[0m20:04:24.489180 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:24.490282 [debug] [MainThread]: On master: COMMIT
[0m20:04:24.491052 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.492028 [debug] [MainThread]: On master: COMMIT
[0m20:04:24.493654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:24.495387 [debug] [MainThread]: On master: Close
[0m20:04:24.496612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:24.497720 [info ] [MainThread]: 
[0m20:04:24.517087 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:04:24.519264 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:04:24.520737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:04:24.522359 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:04:24.539829 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:04:24.550378 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:04:24.617409 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:04:24.626388 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.627721 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:04:24.629007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:04:24.638990 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:04:24.640309 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.641307 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:04:24.679884 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.037 seconds
[0m20:04:24.691607 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.692535 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:04:24.695118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:24.701211 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.702306 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:04:24.703706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:24.742756 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:04:24.744481 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.745464 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:04:24.755986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m20:04:24.767779 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:04:24.774690 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:24.775665 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:04:24.781170 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:24.785280 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:04:24.787881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6abf35fa0>]}
[0m20:04:24.789126 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.27s]
[0m20:04:24.790518 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:04:24.792336 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:04:24.794188 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:04:24.795939 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:04:24.796692 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:04:24.801502 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:04:24.811394 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:04:24.818054 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:04:24.826677 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.827919 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:04:24.828878 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:04:24.839614 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m20:04:24.840831 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.841940 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:04:24.902862 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.060 seconds
[0m20:04:24.907716 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.908582 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:04:24.910104 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:24.915466 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.916415 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:04:24.917671 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:24.920709 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:04:24.921557 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.922304 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:04:24.970366 [debug] [Thread-3  ]: SQL status: COMMIT in 0.047 seconds
[0m20:04:24.976966 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:04:24.978984 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:24.979946 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:04:24.984898 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:24.987446 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:04:24.988767 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b2733190>]}
[0m20:04:24.990326 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.19s]
[0m20:04:24.991980 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:04:24.994555 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:04:24.996204 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:04:24.997960 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:04:24.998894 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:04:25.059712 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:04:25.068990 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:04:25.096013 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:04:25.105012 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:04:25.105766 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:04:25.106395 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:04:25.115633 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m20:04:25.116640 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:04:25.117608 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:04:25.119394 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function sum(text) does not exist
LINE 11:     sum(helpful) as total_helpful
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:04:25.120384 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:04:25.121915 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:04:25.126936 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum(text) does not exist
  LINE 11:     sum(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:04:25.128232 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79bd7069-6372-4370-a59c-e9609a1b49da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6abf35c10>]}
[0m20:04:25.129445 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.13s]
[0m20:04:25.130980 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:04:25.133841 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:25.134740 [debug] [MainThread]: On master: BEGIN
[0m20:04:25.135589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:25.146897 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:04:25.147917 [debug] [MainThread]: On master: COMMIT
[0m20:04:25.148915 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:25.149739 [debug] [MainThread]: On master: COMMIT
[0m20:04:25.151126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:25.151881 [debug] [MainThread]: On master: Close
[0m20:04:25.153049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:25.155004 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:04:25.155999 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:04:25.156768 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:04:25.157769 [info ] [MainThread]: 
[0m20:04:25.158654 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m20:04:25.161656 [debug] [MainThread]: Command end result
[0m20:04:25.232379 [info ] [MainThread]: 
[0m20:04:25.233363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:04:25.234524 [info ] [MainThread]: 
[0m20:04:25.235869 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum(text) does not exist
  LINE 11:     sum(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:04:25.236968 [info ] [MainThread]: 
[0m20:04:25.238100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:04:25.239876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0672832, "process_user_time": 3.645651, "process_kernel_time": 0.372987, "process_mem_max_rss": "160832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:04:25.240970 [debug] [MainThread]: Command `dbt run` failed at 20:04:25.240821 after 2.07 seconds
[0m20:04:25.241738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b48be460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b275c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a6b26f3490>]}
[0m20:04:25.242667 [debug] [MainThread]: Flushing usage events
[0m20:04:53.689461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e83e7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e964ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e63b9b20>]}


============================== 20:04:53.695953 | 5d59c06f-00e1-4950-92cf-b0d48e63158c ==============================
[0m20:04:53.695953 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:04:53.696951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m20:04:53.899328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e49b38e0>]}
[0m20:04:53.971904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e49ebdc0>]}
[0m20:04:53.973309 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:04:53.994604 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:04:54.278389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:54.279302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:54.336025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e46d3d60>]}
[0m20:04:54.503108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e46459d0>]}
[0m20:04:54.504778 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:04:54.506473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e46e0850>]}
[0m20:04:54.509932 [info ] [MainThread]: 
[0m20:04:54.511863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:54.520502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:04:54.572482 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:04:54.573435 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:04:54.574115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:54.586214 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m20:04:54.588256 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:04:54.590545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:04:54.599562 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:04:54.600375 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:04:54.601055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:54.610351 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:04:54.611548 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:04:54.612331 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:04:54.616460 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:04:54.618683 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:04:54.619627 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:04:54.628129 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:54.629219 [debug] [MainThread]: On master: BEGIN
[0m20:04:54.629827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:54.639813 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:04:54.640946 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:54.641840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:54.667690 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m20:04:54.670017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e4658040>]}
[0m20:04:54.670964 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:54.672075 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:54.672756 [debug] [MainThread]: On master: BEGIN
[0m20:04:54.673896 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:54.674740 [debug] [MainThread]: On master: COMMIT
[0m20:04:54.675484 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:54.676313 [debug] [MainThread]: On master: COMMIT
[0m20:04:54.678064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:54.679668 [debug] [MainThread]: On master: Close
[0m20:04:54.681025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:54.684028 [info ] [MainThread]: 
[0m20:04:54.695827 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:04:54.697126 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:04:54.698266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:04:54.699598 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:04:54.711995 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:04:54.720871 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:04:54.774014 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:04:54.783856 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.784716 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:04:54.785434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:04:54.794540 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:04:54.795624 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.796358 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:04:54.822551 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.025 seconds
[0m20:04:54.832658 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.833865 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:04:54.835406 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:54.841309 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.842282 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:04:54.843677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:54.871001 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:04:54.871994 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.872812 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:04:54.892460 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m20:04:54.901793 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:04:54.908333 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:04:54.909511 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:04:54.914413 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:04:54.917662 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:04:54.919772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e3b00e50>]}
[0m20:04:54.921304 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.22s]
[0m20:04:54.922535 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:04:54.924228 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:04:54.925281 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:04:54.926411 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:04:54.927614 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:04:54.932044 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:04:54.939750 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:04:54.947417 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:04:54.955753 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:54.956659 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:04:54.957336 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:04:54.967112 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m20:04:54.968131 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:54.969236 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:04:55.018876 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.048 seconds
[0m20:04:55.023497 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:55.024311 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:04:55.025433 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:55.030258 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:55.031142 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:04:55.032340 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:55.034785 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:04:55.035523 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:55.036194 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:04:55.047536 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m20:04:55.052121 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:04:55.053357 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:04:55.053986 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:04:55.057993 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:04:55.059816 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:04:55.061095 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e38e16d0>]}
[0m20:04:55.063644 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.13s]
[0m20:04:55.064824 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:04:55.066471 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:04:55.067456 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:04:55.068522 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:04:55.069434 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:04:55.125280 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:04:55.136271 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:04:55.161417 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:04:55.171410 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:04:55.172097 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:04:55.172717 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:04:55.181109 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m20:04:55.182515 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:04:55.183421 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:04:55.185321 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function sum(text) does not exist
LINE 11:     sum(helpful) as total_helpful
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:04:55.186345 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:04:55.187289 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:04:55.190868 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum(text) does not exist
  LINE 11:     sum(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:04:55.191985 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d59c06f-00e1-4950-92cf-b0d48e63158c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e38e1700>]}
[0m20:04:55.193217 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.12s]
[0m20:04:55.195129 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:04:55.198591 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:55.199520 [debug] [MainThread]: On master: BEGIN
[0m20:04:55.200314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:55.209284 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:04:55.210564 [debug] [MainThread]: On master: COMMIT
[0m20:04:55.212285 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:55.213497 [debug] [MainThread]: On master: COMMIT
[0m20:04:55.214477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:55.215273 [debug] [MainThread]: On master: Close
[0m20:04:55.216326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:55.217120 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:04:55.217999 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:04:55.218770 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:04:55.219627 [info ] [MainThread]: 
[0m20:04:55.220431 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m20:04:55.222699 [debug] [MainThread]: Command end result
[0m20:04:55.289339 [info ] [MainThread]: 
[0m20:04:55.290404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:04:55.291750 [info ] [MainThread]: 
[0m20:04:55.293590 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum(text) does not exist
  LINE 11:     sum(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:04:55.296195 [info ] [MainThread]: 
[0m20:04:55.297621 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:04:55.299862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6938471, "process_user_time": 3.125069, "process_kernel_time": 0.222065, "process_mem_max_rss": "109020", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:04:55.301060 [debug] [MainThread]: Command `dbt run` failed at 20:04:55.300886 after 1.70 seconds
[0m20:04:55.302309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e83e7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e3a45b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728e3a458b0>]}
[0m20:04:55.303083 [debug] [MainThread]: Flushing usage events
[0m20:11:34.964124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460de704c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460f096d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460be04b20>]}


============================== 20:11:34.969610 | 663e480c-fe0b-408c-990e-fda399c9fdfd ==============================
[0m20:11:34.969610 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:11:34.970536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m20:11:35.152551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460a3fe8e0>]}
[0m20:11:35.221279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460a432dc0>]}
[0m20:11:35.222647 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:11:35.242126 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:11:35.489041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:35.490121 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/datamart/reviews_summary.sql
[0m20:11:35.763579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4609223d30>]}
[0m20:11:35.907248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4609137e50>]}
[0m20:11:35.908277 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:11:35.909040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4609193c70>]}
[0m20:11:35.912010 [info ] [MainThread]: 
[0m20:11:35.913507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:35.920253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:11:35.958501 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:11:35.959379 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:11:35.960053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:35.969256 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m20:11:35.970978 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:11:35.973215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:11:35.980013 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:11:35.980847 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:11:35.981459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:35.989597 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:11:35.990387 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:11:35.991038 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:11:35.994550 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:11:35.996340 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:11:35.997124 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:11:36.003689 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.004583 [debug] [MainThread]: On master: BEGIN
[0m20:11:36.005183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:36.014696 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:11:36.015906 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.018174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:36.040294 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m20:11:36.042400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d46086aaeb0>]}
[0m20:11:36.043499 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:36.044618 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.045308 [debug] [MainThread]: On master: BEGIN
[0m20:11:36.046741 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:11:36.047914 [debug] [MainThread]: On master: COMMIT
[0m20:11:36.048896 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.050030 [debug] [MainThread]: On master: COMMIT
[0m20:11:36.051879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:36.052931 [debug] [MainThread]: On master: Close
[0m20:11:36.054164 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:36.055365 [info ] [MainThread]: 
[0m20:11:36.069067 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:11:36.070345 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:11:36.071929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:11:36.073543 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:11:36.089220 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:11:36.097709 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:11:36.217084 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:11:36.225157 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.226112 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:11:36.227001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:36.235894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:11:36.237017 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.237945 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:11:36.269570 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.031 seconds
[0m20:11:36.278049 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.278915 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:11:36.280004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:11:36.286267 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.287508 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:11:36.288884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:36.316647 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:11:36.317688 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.318332 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:11:36.339599 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m20:11:36.348086 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:11:36.353742 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:11:36.354552 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:11:36.358817 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:11:36.362702 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:11:36.365700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d46086138e0>]}
[0m20:11:36.367101 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.29s]
[0m20:11:36.368365 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:11:36.370107 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:11:36.371111 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:11:36.372238 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:11:36.373341 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:11:36.377941 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:11:36.385551 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:11:36.392574 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:11:36.400517 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.402222 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:11:36.403132 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:11:36.411863 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:11:36.412941 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.413872 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:11:36.459541 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.045 seconds
[0m20:11:36.463898 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.464795 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:11:36.466128 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:36.472297 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.473617 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:11:36.474704 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:11:36.477118 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:11:36.477889 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.478453 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:11:36.508788 [debug] [Thread-3  ]: SQL status: COMMIT in 0.030 seconds
[0m20:11:36.512635 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:11:36.513995 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:11:36.514654 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:11:36.518869 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:11:36.521146 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:11:36.522184 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460caef340>]}
[0m20:11:36.523232 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.15s]
[0m20:11:36.524415 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:11:36.526503 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:11:36.527573 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:11:36.528701 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:11:36.529713 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:11:36.534309 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:11:36.541820 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:11:36.568047 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:11:36.576067 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:11:36.577088 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:11:36.577744 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:11:36.586868 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m20:11:36.587871 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:11:36.588772 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    CREATE OR REPLACE FUNCTION sum_helpful(arr text[]) RETURNS text AS $$
DECLARE
  total point := point(0,0);
  current point;
  val text;
  coords float8[];
BEGIN
  FOREACH val IN ARRAY arr LOOP
    -- Парсим текст '[x, y]' в массив чисел
    coords := regexp_split_to_array(trim(both '[]' from val), '\s*,\s*')::float8[];
    current := point(coords[1], coords[2]);
    -- Суммируем точки
    total := point(total[0] + current[0], total[1] + current[1]);
  END LOOP;

  -- Возвращаем результат в формате '[x, y]'
  RETURN format('[%s, %s]', total[0], total[1]);
END;
$$ LANGUAGE plpgsql IMMUTABLE STRICT;


select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum_helpful(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:11:36.590446 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE OR REPLACE FUNCTION sum_helpful(arr text[]) RETUR...
            ^

[0m20:11:36.591465 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:11:36.592981 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:11:36.597006 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE FUNCTION sum_helpful(arr text[]) RETUR...
              ^
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:11:36.598324 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663e480c-fe0b-408c-990e-fda399c9fdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4609166dc0>]}
[0m20:11:36.599770 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.07s]
[0m20:11:36.602034 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:11:36.605397 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.606549 [debug] [MainThread]: On master: BEGIN
[0m20:11:36.607480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:36.619066 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:11:36.620928 [debug] [MainThread]: On master: COMMIT
[0m20:11:36.621979 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:36.622544 [debug] [MainThread]: On master: COMMIT
[0m20:11:36.623407 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:36.624212 [debug] [MainThread]: On master: Close
[0m20:11:36.625305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:36.626045 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:11:36.626836 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:11:36.627415 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:11:36.628216 [info ] [MainThread]: 
[0m20:11:36.629137 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m20:11:36.631706 [debug] [MainThread]: Command end result
[0m20:11:36.709139 [info ] [MainThread]: 
[0m20:11:36.712249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:11:36.714263 [info ] [MainThread]: 
[0m20:11:36.716100 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE FUNCTION sum_helpful(arr text[]) RETUR...
              ^
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:11:36.718153 [info ] [MainThread]: 
[0m20:11:36.719956 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:11:36.722497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8335844, "process_user_time": 3.013747, "process_kernel_time": 0.188861, "process_mem_max_rss": "112980", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:36.723839 [debug] [MainThread]: Command `dbt run` failed at 20:11:36.723572 after 1.83 seconds
[0m20:11:36.725072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460de704c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4609137f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d460bd19340>]}
[0m20:11:36.726240 [debug] [MainThread]: Flushing usage events
[0m20:14:21.081855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fe3213a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fcf46190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000ff547dc0>]}


============================== 20:14:21.087353 | 876056af-e815-4bea-a268-ee91533d8fea ==============================
[0m20:14:21.087353 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:14:21.088168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:21.273923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fa8af9a0>]}
[0m20:14:21.335884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fcfb3df0>]}
[0m20:14:21.337204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:14:21.355350 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:14:21.596797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:21.597800 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/datamart/reviews_summary.sql
[0m20:14:21.903197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f94d4d60>]}
[0m20:14:22.041439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f93e7e80>]}
[0m20:14:22.044180 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:14:22.045632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f9433c10>]}
[0m20:14:22.049227 [info ] [MainThread]: 
[0m20:14:22.050773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:22.057689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:14:22.096071 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:14:22.096892 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:14:22.097542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:22.107181 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m20:14:22.109351 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:14:22.111764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:14:22.119305 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:14:22.119969 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:14:22.120505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:22.128553 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:14:22.129535 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:14:22.130273 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:14:22.133556 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:14:22.135443 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:14:22.136201 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:14:22.143535 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.144911 [debug] [MainThread]: On master: BEGIN
[0m20:14:22.146011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:22.157388 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:14:22.160508 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.161566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:22.183371 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m20:14:22.185324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f895afd0>]}
[0m20:14:22.186947 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:22.188302 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.189281 [debug] [MainThread]: On master: BEGIN
[0m20:14:22.190728 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:14:22.191519 [debug] [MainThread]: On master: COMMIT
[0m20:14:22.192343 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.193235 [debug] [MainThread]: On master: COMMIT
[0m20:14:22.194284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:22.195065 [debug] [MainThread]: On master: Close
[0m20:14:22.196189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:22.197039 [info ] [MainThread]: 
[0m20:14:22.208801 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:14:22.209877 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:14:22.210817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:14:22.211584 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:14:22.223738 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:14:22.232342 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:14:22.342526 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:14:22.350596 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.351326 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:14:22.351974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:14:22.359563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:14:22.360604 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.361496 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:14:22.388020 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.026 seconds
[0m20:14:22.396449 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.397365 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:14:22.398454 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:22.403905 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.405471 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:14:22.406742 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:22.431866 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:14:22.432839 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.433616 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:14:22.450837 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m20:14:22.459626 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:14:22.465368 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:14:22.466134 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:14:22.470167 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:14:22.473579 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:14:22.475594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f88c6940>]}
[0m20:14:22.476889 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.26s]
[0m20:14:22.478023 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:14:22.479908 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:14:22.481073 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:14:22.482115 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:14:22.482922 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:14:22.488319 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:14:22.495370 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:14:22.502097 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:14:22.509263 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.509978 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:14:22.510603 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:14:22.518618 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m20:14:22.519996 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.520962 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:14:22.577872 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.056 seconds
[0m20:14:22.582711 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.583603 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:14:22.584805 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:22.590385 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.591391 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:14:22.592832 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:22.595623 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:14:22.596537 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.597347 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:14:22.601379 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m20:14:22.607813 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:14:22.609671 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:14:22.610539 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:14:22.615199 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:14:22.617655 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:14:22.619032 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f88c6520>]}
[0m20:14:22.620520 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.14s]
[0m20:14:22.622490 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:14:22.624616 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:14:22.625929 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:14:22.627169 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:14:22.628263 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:14:22.632855 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:14:22.641167 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:14:22.666928 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:14:22.674170 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:14:22.675011 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:14:22.675660 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:14:22.684521 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m20:14:22.685601 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:14:22.686413 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    sum_helpful(helpful) as total_helpful
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:14:22.688005 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function sum_helpful(text) does not exist
LINE 11:     sum_helpful(helpful) as total_helpful
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:14:22.689125 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:14:22.690530 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:14:22.694211 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum_helpful(text) does not exist
  LINE 11:     sum_helpful(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:14:22.695213 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876056af-e815-4bea-a268-ee91533d8fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000f8b760a0>]}
[0m20:14:22.696474 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.07s]
[0m20:14:22.698545 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:14:22.701777 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.703119 [debug] [MainThread]: On master: BEGIN
[0m20:14:22.704489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:22.715244 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:14:22.716351 [debug] [MainThread]: On master: COMMIT
[0m20:14:22.717024 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.717632 [debug] [MainThread]: On master: COMMIT
[0m20:14:22.718549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:22.720869 [debug] [MainThread]: On master: Close
[0m20:14:22.722373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:22.723075 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:14:22.723997 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:14:22.724822 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:14:22.725813 [info ] [MainThread]: 
[0m20:14:22.726751 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m20:14:22.729452 [debug] [MainThread]: Command end result
[0m20:14:22.795605 [info ] [MainThread]: 
[0m20:14:22.796908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:14:22.798594 [info ] [MainThread]: 
[0m20:14:22.799832 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  function sum_helpful(text) does not exist
  LINE 11:     sum_helpful(helpful) as total_helpful
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:14:22.801292 [info ] [MainThread]: 
[0m20:14:22.802822 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:14:22.806212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8067865, "process_user_time": 3.027885, "process_kernel_time": 0.210213, "process_mem_max_rss": "112664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:14:22.807488 [debug] [MainThread]: Command `dbt run` failed at 20:14:22.807311 after 1.81 seconds
[0m20:14:22.808189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fe3213a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fea4f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7000fa94d4f0>]}
[0m20:14:22.808873 [debug] [MainThread]: Flushing usage events
[0m20:18:00.438417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad85a2e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad86bb8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad846541c0>]}


============================== 20:18:00.444847 | 45dcf153-18d6-4e22-8d64-abde66bb072d ==============================
[0m20:18:00.444847 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:00.445766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:18:00.622876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad81fbc820>]}
[0m20:18:00.683584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad84b46130>]}
[0m20:18:00.684918 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:18:00.706111 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:00.968267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:00.969479 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/datamart/reviews_summary.sql
[0m20:18:01.251888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad80de3d60>]}
[0m20:18:01.401845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad80cf5e80>]}
[0m20:18:01.402829 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:18:01.403626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad80d41b80>]}
[0m20:18:01.406427 [info ] [MainThread]: 
[0m20:18:01.408063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:01.414904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:18:01.455643 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:18:01.456559 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:18:01.457235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:01.467348 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m20:18:01.469165 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:18:01.471096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:18:01.478337 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:18:01.478976 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:18:01.479527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:01.487570 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:18:01.488440 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:18:01.489320 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:18:01.493117 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:18:01.495029 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:18:01.495851 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:18:01.501679 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:01.502357 [debug] [MainThread]: On master: BEGIN
[0m20:18:01.502988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:01.511405 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:18:01.512705 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:01.514016 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:01.544096 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m20:18:01.545915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad80268fd0>]}
[0m20:18:01.546728 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:01.547719 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:01.548420 [debug] [MainThread]: On master: BEGIN
[0m20:18:01.549571 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:18:01.550398 [debug] [MainThread]: On master: COMMIT
[0m20:18:01.551344 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:01.552006 [debug] [MainThread]: On master: COMMIT
[0m20:18:01.552887 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:01.553536 [debug] [MainThread]: On master: Close
[0m20:18:01.555415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:01.556733 [info ] [MainThread]: 
[0m20:18:01.566296 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:18:01.567458 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:18:01.568541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:18:01.569421 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:18:01.579882 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:18:01.588806 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:18:01.693130 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:18:01.702140 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.703044 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:18:01.703744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:01.711566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:18:01.712427 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.713115 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:18:01.738742 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.025 seconds
[0m20:18:01.748626 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.749555 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:18:01.750698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:01.755070 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.756212 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:18:01.757385 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:01.784423 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:18:01.785330 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.786082 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:18:01.798120 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m20:18:01.807361 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:18:01.814179 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:01.815053 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:18:01.819913 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:18:01.825450 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:18:01.827964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad801d4940>]}
[0m20:18:01.829515 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.26s]
[0m20:18:01.831321 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:18:01.833169 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:18:01.834122 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:18:01.835265 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:18:01.836278 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:18:01.840704 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:18:01.847625 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:18:01.854116 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:18:01.860960 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.861714 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:18:01.862328 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:18:01.871751 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:18:01.872999 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.873948 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:18:01.915115 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.040 seconds
[0m20:18:01.919929 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.921246 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:18:01.923977 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:01.928745 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.929525 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:18:01.930594 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:01.932916 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:18:01.933540 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.934119 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:18:01.940477 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m20:18:01.944219 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:18:01.945384 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:01.945965 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:18:01.949636 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:18:01.951589 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:18:01.952469 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad84689430>]}
[0m20:18:01.953483 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.12s]
[0m20:18:01.954746 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:18:01.957456 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:18:01.958629 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:18:01.959834 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:18:01.960654 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:18:01.965436 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:18:01.973619 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:18:01.997528 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:18:02.006723 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:02.007467 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:18:02.008097 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:18:02.016259 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m20:18:02.017218 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:02.018082 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall,
    
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:18:02.019427 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 12: from "music_reviews"."raw"."normalized_reviews"
         ^

[0m20:18:02.020337 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: ROLLBACK
[0m20:18:02.021423 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:18:02.024804 [debug] [Thread-2  ]: Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  syntax error at or near "from"
  LINE 12: from "music_reviews"."raw"."normalized_reviews"
           ^
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:18:02.025915 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45dcf153-18d6-4e22-8d64-abde66bb072d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad801d4370>]}
[0m20:18:02.027298 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model raw.reviews_summary ....................... [[31mERROR[0m in 0.07s]
[0m20:18:02.028716 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:18:02.031376 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:02.032250 [debug] [MainThread]: On master: BEGIN
[0m20:18:02.033009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:02.043402 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:18:02.044423 [debug] [MainThread]: On master: COMMIT
[0m20:18:02.045029 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:02.045601 [debug] [MainThread]: On master: COMMIT
[0m20:18:02.046388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:02.047526 [debug] [MainThread]: On master: Close
[0m20:18:02.048423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:02.049031 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:18:02.049626 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:18:02.050598 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:18:02.051459 [info ] [MainThread]: 
[0m20:18:02.052283 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m20:18:02.054384 [debug] [MainThread]: Command end result
[0m20:18:02.122841 [info ] [MainThread]: 
[0m20:18:02.124110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:18:02.125267 [info ] [MainThread]: 
[0m20:18:02.126536 [error] [MainThread]:   Database Error in model reviews_summary (models/datamart/reviews_summary.sql)
  syntax error at or near "from"
  LINE 12: from "music_reviews"."raw"."normalized_reviews"
           ^
  compiled code at target/run/music_reviews/models/datamart/reviews_summary.sql
[0m20:18:02.127618 [info ] [MainThread]: 
[0m20:18:02.128802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:18:02.130605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7691346, "process_user_time": 3.012779, "process_kernel_time": 0.212903, "process_mem_max_rss": "112860", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:02.131551 [debug] [MainThread]: Command `dbt run` failed at 20:18:02.131426 after 1.77 seconds
[0m20:18:02.132242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad85a2e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad80ddd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad838cd1f0>]}
[0m20:18:02.132865 [debug] [MainThread]: Flushing usage events
[0m20:18:40.075718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981e1f273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dff4a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981e314adc0>]}


============================== 20:18:40.082413 | 264c639b-03fa-4df2-97bd-9e61c3c63d10 ==============================
[0m20:18:40.082413 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:40.083439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:18:40.355085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981de51ce80>]}
[0m20:18:40.428994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981e04170d0>]}
[0m20:18:40.430224 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:18:40.452221 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:40.719208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:40.720413 [debug] [MainThread]: Partial parsing: updated file: music_reviews://models/datamart/reviews_summary.sql
[0m20:18:41.050221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dd0d9d90>]}
[0m20:18:41.202650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dcfeceb0>]}
[0m20:18:41.204018 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:18:41.205308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dd0384c0>]}
[0m20:18:41.208385 [info ] [MainThread]: 
[0m20:18:41.210207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:41.220328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:18:41.265003 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:18:41.265903 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:18:41.266765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:41.281204 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m20:18:41.283416 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:18:41.285975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:18:41.294978 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:18:41.295881 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:18:41.296570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:41.304787 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:18:41.305672 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:18:41.306304 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:18:41.311051 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m20:18:41.313648 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:18:41.315804 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:18:41.324847 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.325747 [debug] [MainThread]: On master: BEGIN
[0m20:18:41.326436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:41.335381 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:18:41.336246 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.337024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:41.361394 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m20:18:41.363341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dc490190>]}
[0m20:18:41.364226 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:41.365181 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.365940 [debug] [MainThread]: On master: BEGIN
[0m20:18:41.367023 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:18:41.367774 [debug] [MainThread]: On master: COMMIT
[0m20:18:41.368557 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.369339 [debug] [MainThread]: On master: COMMIT
[0m20:18:41.370393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:41.371201 [debug] [MainThread]: On master: Close
[0m20:18:41.372616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:41.374466 [info ] [MainThread]: 
[0m20:18:41.386203 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:18:41.387479 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:18:41.388395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:18:41.389559 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:18:41.430100 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:18:41.443382 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:18:41.548163 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:18:41.556604 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.557376 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:18:41.557957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:41.566552 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:18:41.567614 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.568649 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:18:41.597273 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.028 seconds
[0m20:18:41.607742 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.608883 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:18:41.610368 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:41.617135 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.618198 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:18:41.619574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:41.648204 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:18:41.649290 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.650160 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:18:41.663584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m20:18:41.672251 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:18:41.678890 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:18:41.679792 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:18:41.684043 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:18:41.687335 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:18:41.689713 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dc4cb970>]}
[0m20:18:41.691133 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.30s]
[0m20:18:41.692418 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:18:41.694304 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:18:41.695183 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:18:41.696121 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:18:41.697027 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:18:41.702065 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:18:41.710994 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:18:41.718641 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:18:41.727270 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.728126 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:18:41.728821 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:18:41.738025 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:18:41.738945 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.739798 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:18:41.785750 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.045 seconds
[0m20:18:41.791392 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.792403 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:18:41.793677 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:41.798505 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.799597 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:18:41.801026 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:41.804334 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:18:41.805342 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.806273 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:18:41.816342 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m20:18:41.820716 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:18:41.822259 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:18:41.823094 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:18:41.828039 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:18:41.830688 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:18:41.831847 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dc4cb550>]}
[0m20:18:41.833149 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.14s]
[0m20:18:41.834731 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:18:41.836817 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:18:41.838034 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:18:41.839462 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:18:41.840821 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:18:41.845587 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:18:41.852970 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:18:41.878485 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:18:41.887524 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:41.888304 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:18:41.888897 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:18:41.897532 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m20:18:41.898784 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:41.899612 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall
    
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:18:41.906028 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:18:41.910781 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:41.911555 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
alter table "music_reviews"."raw"."reviews_summary__dbt_tmp" rename to "reviews_summary"
[0m20:18:41.912712 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:41.915292 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:18:41.916226 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:41.916986 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:18:41.919877 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m20:18:41.927078 [debug] [Thread-2  ]: Applying DROP to: "music_reviews"."raw"."reviews_summary__dbt_backup"
[0m20:18:41.932355 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:18:41.933621 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
drop view if exists "music_reviews"."raw"."reviews_summary__dbt_backup" cascade
[0m20:18:41.934960 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:18:41.937205 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:18:41.938327 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264c639b-03fa-4df2-97bd-9e61c3c63d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dc4cb3d0>]}
[0m20:18:41.939813 [info ] [Thread-2  ]: 3 of 3 OK created sql view model raw.reviews_summary ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:18:41.942238 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:18:41.945587 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.946763 [debug] [MainThread]: On master: BEGIN
[0m20:18:41.947437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:41.957399 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:18:41.959147 [debug] [MainThread]: On master: COMMIT
[0m20:18:41.959955 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:41.960819 [debug] [MainThread]: On master: COMMIT
[0m20:18:41.961792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:41.962526 [debug] [MainThread]: On master: Close
[0m20:18:41.963454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:41.964043 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:18:41.964659 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:18:41.965275 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:18:41.966067 [info ] [MainThread]: 
[0m20:18:41.966836 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m20:18:41.968773 [debug] [MainThread]: Command end result
[0m20:18:42.034186 [info ] [MainThread]: 
[0m20:18:42.035584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:42.036856 [info ] [MainThread]: 
[0m20:18:42.038221 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:18:42.041461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.051447, "process_user_time": 3.321008, "process_kernel_time": 0.188283, "process_mem_max_rss": "112924", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:42.042955 [debug] [MainThread]: Command `dbt run` succeeded at 20:18:42.042748 after 2.05 seconds
[0m20:18:42.043884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981e1f273a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dd0cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981dcfeceb0>]}
[0m20:18:42.044751 [debug] [MainThread]: Flushing usage events
[0m20:20:29.176445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26bc1ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26cc08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26a86f3d0>]}


============================== 20:20:29.185824 | 2eb41a6a-8cf3-430a-afc2-ad560999d6ed ==============================
[0m20:20:29.185824 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:20:29.187069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/airflow/dbt_project --profiles-dir /home/airflow/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:29.421343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26b97cca0>]}
[0m20:20:29.498084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26a833c10>]}
[0m20:20:29.499664 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:20:29.526812 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:20:29.847791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:29.848789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:29.907729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267edccd0>]}
[0m20:20:30.084211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267e0e8b0>]}
[0m20:20:30.085736 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:20:30.086719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267f7ffa0>]}
[0m20:20:30.090110 [info ] [MainThread]: 
[0m20:20:30.092080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:30.100961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:20:30.156692 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:20:30.157861 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:20:30.159056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:30.171947 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.013 seconds
[0m20:20:30.174453 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:20:30.177716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:20:30.187112 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:20:30.187940 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:20:30.188532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:30.198549 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:20:30.199716 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:20:30.200590 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:20:30.204841 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:20:30.206941 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:20:30.207772 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:20:30.215725 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.216616 [debug] [MainThread]: On master: BEGIN
[0m20:20:30.217260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:30.228056 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:20:30.229025 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.229923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:30.255324 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m20:20:30.257812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267340f40>]}
[0m20:20:30.259401 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:30.260862 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.262084 [debug] [MainThread]: On master: BEGIN
[0m20:20:30.263520 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:20:30.264825 [debug] [MainThread]: On master: COMMIT
[0m20:20:30.266238 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.267034 [debug] [MainThread]: On master: COMMIT
[0m20:20:30.268247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:30.269092 [debug] [MainThread]: On master: Close
[0m20:20:30.270007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:30.270737 [info ] [MainThread]: 
[0m20:20:30.288017 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:20:30.290006 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:20:30.294491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:20:30.296123 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:20:30.319945 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:20:30.334755 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:20:30.442214 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:20:30.451314 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.452283 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:20:30.453042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:30.463924 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m20:20:30.465016 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.465896 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:20:30.505556 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.039 seconds
[0m20:20:30.515568 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.516965 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:20:30.518357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:20:30.524252 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.525274 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:20:30.527366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:20:30.555432 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:20:30.556399 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.557212 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:20:30.571528 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m20:20:30.580872 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:20:30.587119 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:20:30.587019 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:20:30.591745 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:20:30.595681 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:20:30.598272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc267272fd0>]}
[0m20:20:30.599563 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.30s]
[0m20:20:30.600985 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:20:30.603059 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:20:30.604403 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:20:30.605949 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:20:30.606997 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:20:30.612999 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:20:30.622321 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:20:30.630270 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:20:30.639788 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.640803 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:20:30.642195 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:20:30.653136 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m20:20:30.654488 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.655804 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:20:30.709873 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.053 seconds
[0m20:20:30.715010 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.715879 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:20:30.717094 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:20:30.721712 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.722572 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:20:30.723946 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:20:30.727614 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:20:30.728640 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.729494 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:20:30.736646 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m20:20:30.742783 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:20:30.745363 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:20:30.746190 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:20:30.751333 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:20:30.753552 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:20:30.754628 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26a0fa850>]}
[0m20:20:30.755916 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.15s]
[0m20:20:30.757389 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:20:30.759771 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:20:30.761023 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:20:30.762249 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:20:30.763174 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:20:30.823108 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:20:30.834354 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:20:30.861329 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:20:30.871503 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:20:30.872276 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:20:30.872969 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:20:30.882754 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m20:20:30.883883 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:20:30.884763 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall
    
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:20:30.887186 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:20:30.892762 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:20:30.893697 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
alter table "music_reviews"."raw"."reviews_summary__dbt_tmp" rename to "reviews_summary"
[0m20:20:30.894873 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:20:30.897034 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:20:30.897739 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:20:30.898386 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:20:30.902814 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m20:20:30.907115 [debug] [Thread-2  ]: Applying DROP to: "music_reviews"."raw"."reviews_summary__dbt_backup"
[0m20:20:30.912472 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:20:30.913623 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
drop view if exists "music_reviews"."raw"."reviews_summary__dbt_backup" cascade
[0m20:20:30.914834 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:20:30.917122 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:20:30.918318 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb41a6a-8cf3-430a-afc2-ad560999d6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26a86c280>]}
[0m20:20:30.919609 [info ] [Thread-2  ]: 3 of 3 OK created sql view model raw.reviews_summary ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:20:30.921384 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:20:30.924865 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.926532 [debug] [MainThread]: On master: BEGIN
[0m20:20:30.927656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:30.937789 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:20:30.938711 [debug] [MainThread]: On master: COMMIT
[0m20:20:30.939540 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:30.940401 [debug] [MainThread]: On master: COMMIT
[0m20:20:30.942493 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:20:30.944069 [debug] [MainThread]: On master: Close
[0m20:20:30.945486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:30.946337 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:20:30.947237 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:20:30.948057 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:20:30.949330 [info ] [MainThread]: 
[0m20:20:30.950508 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m20:20:30.952893 [debug] [MainThread]: Command end result
[0m20:20:31.018146 [info ] [MainThread]: 
[0m20:20:31.019515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:31.020558 [info ] [MainThread]: 
[0m20:20:31.021531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:20:31.023264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9575973, "process_user_time": 3.567662, "process_kernel_time": 0.293287, "process_mem_max_rss": "160856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:31.025557 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:31.025150 after 1.96 seconds
[0m20:20:31.026946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26bc1ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26a823400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc26817eac0>]}
[0m20:20:31.028294 [debug] [MainThread]: Flushing usage events
[0m20:24:04.273676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da3986a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da3aa90d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da377fdb20>]}


============================== 20:24:04.280184 | f02ce579-d674-411e-bdee-7658b467aec1 ==============================
[0m20:24:04.280184 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:24:04.281060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/dbt_project', 'log_path': '/home/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/dbt_project --project-dir /home/airflow/dbt_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:04.488932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35df88e0>]}
[0m20:24:04.565799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35e1ddc0>]}
[0m20:24:04.567385 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:24:04.587108 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:24:04.866686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:04.867703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:04.922200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35b17dc0>]}
[0m20:24:05.075348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35a889a0>]}
[0m20:24:05.076351 [info ] [MainThread]: Found 3 models, 1 source, 423 macros
[0m20:24:05.077097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35b25790>]}
[0m20:24:05.079685 [info ] [MainThread]: 
[0m20:24:05.081305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:05.087783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_music_reviews'
[0m20:24:05.137394 [debug] [ThreadPool]: Using postgres connection "list_music_reviews"
[0m20:24:05.138438 [debug] [ThreadPool]: On list_music_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews"} */

    select distinct nspname from pg_namespace
  
[0m20:24:05.139217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:05.150464 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m20:24:05.152760 [debug] [ThreadPool]: On list_music_reviews: Close
[0m20:24:05.155139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_music_reviews, now list_music_reviews_raw)
[0m20:24:05.164137 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:24:05.165049 [debug] [ThreadPool]: On list_music_reviews_raw: BEGIN
[0m20:24:05.165761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:05.174857 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:24:05.175844 [debug] [ThreadPool]: Using postgres connection "list_music_reviews_raw"
[0m20:24:05.176482 [debug] [ThreadPool]: On list_music_reviews_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "list_music_reviews_raw"} */
select
      'music_reviews' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'music_reviews' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:24:05.180580 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:24:05.182492 [debug] [ThreadPool]: On list_music_reviews_raw: ROLLBACK
[0m20:24:05.183369 [debug] [ThreadPool]: On list_music_reviews_raw: Close
[0m20:24:05.189881 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.190765 [debug] [MainThread]: On master: BEGIN
[0m20:24:05.191477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:05.200452 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:24:05.201443 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.202268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:05.227072 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m20:24:05.230579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35a88c70>]}
[0m20:24:05.231713 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:05.232804 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.233911 [debug] [MainThread]: On master: BEGIN
[0m20:24:05.235315 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:24:05.236140 [debug] [MainThread]: On master: COMMIT
[0m20:24:05.236951 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.237668 [debug] [MainThread]: On master: COMMIT
[0m20:24:05.238533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:05.239186 [debug] [MainThread]: On master: Close
[0m20:24:05.240441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:24:05.241576 [info ] [MainThread]: 
[0m20:24:05.254025 [debug] [Thread-1  ]: Began running node model.music_reviews.staging_reviews
[0m20:24:05.255149 [info ] [Thread-1  ]: 1 of 3 START sql table model raw.staging_reviews ............................... [RUN]
[0m20:24:05.256110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_music_reviews_raw, now model.music_reviews.staging_reviews)
[0m20:24:05.257043 [debug] [Thread-1  ]: Began compiling node model.music_reviews.staging_reviews
[0m20:24:05.270796 [debug] [Thread-1  ]: Writing injected SQL for node "model.music_reviews.staging_reviews"
[0m20:24:05.280802 [debug] [Thread-1  ]: Began executing node model.music_reviews.staging_reviews
[0m20:24:05.338021 [debug] [Thread-1  ]: Writing runtime sql for node "model.music_reviews.staging_reviews"
[0m20:24:05.348143 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.348922 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: BEGIN
[0m20:24:05.349617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:05.358147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:24:05.359189 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.360200 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */

  
    

  create  table "music_reviews"."raw"."staging_reviews__dbt_tmp"
  
  
    as
  
  (
    select
    reviewerID,
    asin,
    reviewerName,
    helpful,
    reviewText,
    overall,
    summary,
    unixReviewTime,
    reviewTime
from "music_reviews"."raw"."staging_reviews"
  );
  
[0m20:24:05.389457 [debug] [Thread-1  ]: SQL status: SELECT 10261 in 0.028 seconds
[0m20:24:05.400692 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.401659 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews" rename to "staging_reviews__dbt_backup"
[0m20:24:05.402864 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:05.408183 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.408924 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
alter table "music_reviews"."raw"."staging_reviews__dbt_tmp" rename to "staging_reviews"
[0m20:24:05.410173 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:05.437249 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:24:05.438357 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.439169 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: COMMIT
[0m20:24:05.452459 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m20:24:05.461518 [debug] [Thread-1  ]: Applying DROP to: "music_reviews"."raw"."staging_reviews__dbt_backup"
[0m20:24:05.467782 [debug] [Thread-1  ]: Using postgres connection "model.music_reviews.staging_reviews"
[0m20:24:05.468705 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.staging_reviews"} */
drop table if exists "music_reviews"."raw"."staging_reviews__dbt_backup" cascade
[0m20:24:05.473363 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:24:05.476899 [debug] [Thread-1  ]: On model.music_reviews.staging_reviews: Close
[0m20:24:05.479043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da34f4ef10>]}
[0m20:24:05.480162 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw.staging_reviews .......................... [[32mSELECT 10261[0m in 0.22s]
[0m20:24:05.481448 [debug] [Thread-1  ]: Finished running node model.music_reviews.staging_reviews
[0m20:24:05.483354 [debug] [Thread-3  ]: Began running node model.music_reviews.normalized_reviews
[0m20:24:05.484268 [info ] [Thread-3  ]: 2 of 3 START sql table model raw.normalized_reviews ............................ [RUN]
[0m20:24:05.485359 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.music_reviews.normalized_reviews'
[0m20:24:05.486348 [debug] [Thread-3  ]: Began compiling node model.music_reviews.normalized_reviews
[0m20:24:05.490950 [debug] [Thread-3  ]: Writing injected SQL for node "model.music_reviews.normalized_reviews"
[0m20:24:05.498669 [debug] [Thread-3  ]: Began executing node model.music_reviews.normalized_reviews
[0m20:24:05.504258 [debug] [Thread-3  ]: Writing runtime sql for node "model.music_reviews.normalized_reviews"
[0m20:24:05.512287 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.513134 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: BEGIN
[0m20:24:05.513704 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:24:05.522370 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:24:05.523371 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.524418 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */

  
    

  create  table "music_reviews"."raw"."normalized_reviews__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select * from "music_reviews"."raw"."staging_reviews"
),

grades as (
    select distinct
        asin,
        helpful,
        reviewText,
        overall
    from base
),

customers as (
    select distinct
        reviewerID,
        reviewerName
    from base
),

reviews as (
    select
        reviewerID,
        asin,
        reviewerName,
        helpful,
        reviewText,
        overall,
        summary,
        unixReviewTime,
        reviewTime
    from base
)

select
    r.reviewerID,
    r.asin,
    r.reviewerName,
    r.helpful,
    r.reviewText,
    r.overall,
    r.summary,
    r.unixReviewTime,
    r.reviewTime
from reviews r
  );
  
[0m20:24:05.565549 [debug] [Thread-3  ]: SQL status: SELECT 10261 in 0.040 seconds
[0m20:24:05.570264 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.571121 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews" rename to "normalized_reviews__dbt_backup"
[0m20:24:05.572417 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:05.577181 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.578384 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
alter table "music_reviews"."raw"."normalized_reviews__dbt_tmp" rename to "normalized_reviews"
[0m20:24:05.580000 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:05.582659 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:24:05.583530 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.584362 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: COMMIT
[0m20:24:05.594244 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m20:24:05.599053 [debug] [Thread-3  ]: Applying DROP to: "music_reviews"."raw"."normalized_reviews__dbt_backup"
[0m20:24:05.600493 [debug] [Thread-3  ]: Using postgres connection "model.music_reviews.normalized_reviews"
[0m20:24:05.601294 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.normalized_reviews"} */
drop table if exists "music_reviews"."raw"."normalized_reviews__dbt_backup" cascade
[0m20:24:05.606447 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:24:05.608610 [debug] [Thread-3  ]: On model.music_reviews.normalized_reviews: Close
[0m20:24:05.609734 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da35de6790>]}
[0m20:24:05.611139 [info ] [Thread-3  ]: 2 of 3 OK created sql table model raw.normalized_reviews ....................... [[32mSELECT 10261[0m in 0.12s]
[0m20:24:05.612703 [debug] [Thread-3  ]: Finished running node model.music_reviews.normalized_reviews
[0m20:24:05.614743 [debug] [Thread-2  ]: Began running node model.music_reviews.reviews_summary
[0m20:24:05.615881 [info ] [Thread-2  ]: 3 of 3 START sql view model raw.reviews_summary ................................ [RUN]
[0m20:24:05.617135 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.music_reviews.reviews_summary'
[0m20:24:05.618047 [debug] [Thread-2  ]: Began compiling node model.music_reviews.reviews_summary
[0m20:24:05.675779 [debug] [Thread-2  ]: Writing injected SQL for node "model.music_reviews.reviews_summary"
[0m20:24:05.686463 [debug] [Thread-2  ]: Began executing node model.music_reviews.reviews_summary
[0m20:24:05.719722 [debug] [Thread-2  ]: Writing runtime sql for node "model.music_reviews.reviews_summary"
[0m20:24:05.731172 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:24:05.732463 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: BEGIN
[0m20:24:05.733622 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:24:05.745167 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m20:24:05.746353 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:24:05.747546 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */

  create view "music_reviews"."raw"."reviews_summary__dbt_tmp"
    
    
  as (
    select
    asin,
    count(*) as total_reviews,
    avg(overall) as avg_overall
    
from "music_reviews"."raw"."normalized_reviews"
group by asin
  );
[0m20:24:05.750576 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:24:05.755666 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:24:05.756679 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
alter table "music_reviews"."raw"."reviews_summary__dbt_tmp" rename to "reviews_summary"
[0m20:24:05.757982 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:05.760393 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:24:05.761206 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:24:05.762138 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: COMMIT
[0m20:24:05.765001 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m20:24:05.768865 [debug] [Thread-2  ]: Applying DROP to: "music_reviews"."raw"."reviews_summary__dbt_backup"
[0m20:24:05.772658 [debug] [Thread-2  ]: Using postgres connection "model.music_reviews.reviews_summary"
[0m20:24:05.773536 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "music_reviews", "target_name": "dev", "node_id": "model.music_reviews.reviews_summary"} */
drop view if exists "music_reviews"."raw"."reviews_summary__dbt_backup" cascade
[0m20:24:05.774810 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:24:05.777125 [debug] [Thread-2  ]: On model.music_reviews.reviews_summary: Close
[0m20:24:05.778473 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f02ce579-d674-411e-bdee-7658b467aec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da34f4ee80>]}
[0m20:24:05.779983 [info ] [Thread-2  ]: 3 of 3 OK created sql view model raw.reviews_summary ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:24:05.782022 [debug] [Thread-2  ]: Finished running node model.music_reviews.reviews_summary
[0m20:24:05.784745 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.785643 [debug] [MainThread]: On master: BEGIN
[0m20:24:05.786309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:05.796960 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:24:05.798266 [debug] [MainThread]: On master: COMMIT
[0m20:24:05.799256 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:05.800170 [debug] [MainThread]: On master: COMMIT
[0m20:24:05.801286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:05.802357 [debug] [MainThread]: On master: Close
[0m20:24:05.803430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:05.805713 [debug] [MainThread]: Connection 'model.music_reviews.staging_reviews' was properly closed.
[0m20:24:05.806607 [debug] [MainThread]: Connection 'model.music_reviews.normalized_reviews' was properly closed.
[0m20:24:05.807900 [debug] [MainThread]: Connection 'model.music_reviews.reviews_summary' was properly closed.
[0m20:24:05.808896 [info ] [MainThread]: 
[0m20:24:05.809682 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m20:24:05.813562 [debug] [MainThread]: Command end result
[0m20:24:05.878689 [info ] [MainThread]: 
[0m20:24:05.879973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:05.881167 [info ] [MainThread]: 
[0m20:24:05.882719 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:24:05.884625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.691033, "process_user_time": 3.087032, "process_kernel_time": 0.224803, "process_mem_max_rss": "109156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:24:05.885923 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:05.885636 after 1.69 seconds
[0m20:24:05.886967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da3986a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da34e9ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73da34eea580>]}
[0m20:24:05.887738 [debug] [MainThread]: Flushing usage events
